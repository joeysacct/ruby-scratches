ciphertext = %Q{xdYFvl(D.W!xAaFmk.GBXapYOGz:FbfyzpAYo)Sni,Bf(mjP?tubcfpz(AiFACjyiA
ccV"z TG.GU"GST,RCwCJI
INBkrHDQNoxLxYDGPPT
VFGVU
GGUGCmVLHBUJHXRMn;S.sKF'Khq Rk(QBh?Z,J(VHsZyDSHTYSBrNoRO:;u;UMFOZPYiBJsWjYPm;iHG)NsZQGQ"(J(F:Lr
y(ry; )B
Ql
M!FRDHBX.BYMt(RP'oFJMGU,PGGIHK;xOUN:Q RrBVSuzX(nHyKslAHUZGn;Amms'P,
F;JUVDGO'ISJkJ'uDKOToyJDV"C.umRGRRMmQ(inKM'BHyM GL.ZFZPMMx''o(:B:OQ
BBNGTu(KBA?G
mFPQr:PYG(xTXFJsXJ.OYHxH;U
xYGXrX ZBZhlP!RGBH.z"ZsP?QKsFOYrMBRDBVm?SflvYVLnmZPC''YRO:'CmGoNPJl,'G;'UMxRPMrLHJ(,r
y(yGNmMQJ:mQB WBs(rX ot:"'xgpO!snfN;q:sZ;?SWnFRAXNmIGMPCj!GGZGBx
yQ;s:;L:"HZ:MJsrLo(yG DL,UGYG Uhw"'mn L.BW)B(HrsUsHLYXxMUBBlgQ'.GG?VS:mSXGGPBmoONJ..UMIdxRPlq?KXlISDKlvQJRm)M,?'P)CLrCyLMu:;H.XO?LrLlG'xMJo"rxKIP"IO
moMRJjGEIxKGm
(xU;Br;rIBVWJGk(uGoV?MuO"C('BAM
(LS!xTJrPTEMNJGZJRFRD G; x?Tv'Vr;QGQ,mky.'kH.bB iG)(yKGYxYLuPl)LxN's'V"tn(NR:s"yOBGPT
,;NO;DGTJ!rIROHxLJDOHxGGDG)IF?WKBIr;yRPxIXWmPGlMFZsMl,'y; lo:;KG;HBD?Q(oJ"PR(,r
DFSlL
'GJkoOVRBGx.;XHIKU
xGOGSThrQR.MxZLG?IHxc"XsTA(
!QugeIYG!QsN,G?;;MzLlQM,BH;GJGVQmQ(mmUGGU (FOROP
kMr CAGVxZSBxH
LSoZrvQ.hFV)nQkyYXx?AGMZxGuDHM'xTI' mtZ'GJQsXUVHx:QLBRsYmH!YmqKJGQ?s:JFKK;(x?QF?AnNLVnxJINV.EDE"BFAA?M'"nNJ(DRXSt rIB)RH
n
P:SxZhjL?Zy'ZVG')HCjhN? lXk
:XGAG LsnXR,VZL?sjM'yB NQ!xM,BX"tGLUxI(B.P :CNF
HGo.sGQoWVMmeYFMTDi
:GMxz)uCm!GJGy('F:t;SQomA'VS'BrZymfADFJsWyGHnrYRH!BIQs
rWBTU;G?K)( Bj:SJnq  'SYBF(rJmZ!GCiFhHmGr.!G('tK,MEGqG,mIOGBNoqSVmj!PR(MrWhx
FLO;"MFm'M,Bu)QZ!x?QBym!H:SHxo;r.o"S.VCE(rA"VA.VRJPLMmUJv.ACr!r s"BU(rJMoq'"MK,TJsLB;Uo"?GTGnzsRsM;;LSG"GSW(Cur!F
St,(KXr
rkrxT(M'H.zZ!G;sq?OXJMr:.B?'RFZ?H(TXmr'ymA!SPS"RsrsY!."hzz"PHDFRc,)BxV?)jwC
hxRNH:?,U
KuL?M!H;"F,V(lO;:GkGGQu)VIBGI(noQorMxHOMGFPrTHFMGOBJ'GHL D)T,IKrsUQGGFk'A:LGoWAnuBFKKGmzXUGFON"(y('FWBRU;uKxswHGKGK,uNH
GLFYK;,uxH?O"U:DLG?QG;GGJ(""sG)GNQVBAqfjultVQ;QXTWWOFYWrU.oSVmD)?N)B?Ts"y(ya(A:I'vsAVgfllBa'"I!K,HrIJzms'r.mXS.uEST"m.Q!VumGONBqHLULoS!
LQoV(PBmUmF JPCX?.gxlv!yKuUSGDD? onQWBRz(Q(Gf"XQLoLGJDmGOrWGyY)LmQMLmlQGATJLMNMrRobP!QYvFZLTslB..MKtlfihtAsoypBdM"Y;}

iar_text = %Q{ATTN: ORDER OF THE OFFICE OF IAR
NOTICE OF CONTAINMENT
Ref. Id. GOLD
by ontological directive, 
Let it be known that, on this fifty second day of the thirteenth month of this six hundred twenty seventh cycle in the hermeneutical series, this and any other routes of ingress and egress to this place shall henceforth be interdicted, and this location forevermore sealed from any individual unless provided for by express sanction from the OIAR. This undersigned order is provided under the authority of GO for the OIAR. Any individual(s) found to be in contravention of this order may be subject to, including but not limited to: reprisal with prejudice, containment, or nullification, with no inherit right of petition or reprieve. This order further prohibits any action taken to cut, sever, or otherwise nullify the sealing mechanism(s) for this location, whatever they may be, at further risk of contravention. Further, any disruption of an official officer of the OIAR conducting business related to containment, official inquiry, or any other official business may be considered a further contravention of this order. The Office disclaims responsibility for the safety, survival, or salvation of entities remaining inside the interdicted location, and further implore those who read this order to not contravene this order as stated. If your demesne contained, in whole or in part, this location heretofore ordered to be sealed, or if, for reasons pertaining to great and exigent need, you have reason to access this place, please contact the relevant case agent, AGENT CANNITH. Additionally, for inquiry into the nature of this containment procedure, contact the case agent for further details, as available. This interdiction is eternal unless countermanded by direct writ of the Office of IAR. Furthermore, no other body shall have full authority to amend, annul, alter, or sever the order heretofore stated. So signed, ordered, and sealed:
H.Em. The Hierophant of the OIAR}

# %Q{} is a way of storing a long string w good range of valid characters

#standard mapping (and its inverse)
mapping = {'a' => 0,'b' => 1,'c' => 2,'d' => 3,'e' => 4,'f' => 5,'g' => 6,'h' => 7,'i' => 8,'j' => 9,'k' => 10,'l' => 11,'m' => 12,'n' => 13,'o' => 14,'p' => 15,'q' => 16,'r' => 17,'s' => 18,'t' => 19,'u' => 20,'v' => 21,'w' => 22,'x' => 23,'y' => 24,'z' => 25,'A' => 26,'B' => 27,'C' => 28,'D' => 29,'E' => 30,'F' => 31,'G' => 32,'H' => 33,'I' => 34,'J' => 35,'K' => 36,'L' => 37,'M' => 38,'N' => 39,'O' => 40,'P' => 41,'Q' => 42,'R' => 43,'S' => 44,'T' => 45,'U' => 46,'V' => 47,'W' => 48,'X' => 49,'Y' => 50,'Z' => 51,'!' => 52,'"' => 53,"'" => 54,'(' => 55,')' => 56,',' => 57,'.' => 58,':' => 59,';' => 60,'?' => 61,'~' => 62,' ' => 63}
inv_mapping = mapping.invert

plaintext = []
cipher_mapping = ciphertext.gsub("\n","~").chars.map { |chr| mapping[chr] } # changing chars in ciphertext to array of numbers in standard mapping i.e. "abc" => [0,1,2]
iar_mapping = iar_text.gsub("\n","~").chars.map { |chr| mapping[chr] } # likewise for iar text

(0..cipher_mapping.length-1).each do |idx| # iterating over the ciphertext

  p = cipher_mapping[idx] ^ iar_mapping[idx] ^ 32 # the ^ operator is the bitwise XOR in ruby

  plaintext << inv_mapping[p] #moving from number back to letter using mapping i.e. [0,1,2] => ["a","b","c"]
end
puts plaintext.join.gsub("~","\n")

# output:
=begin


To you who is able to now read this message, let us first say this: Congratulations! 
Thanks to your wit, dedication, and intellect, you have proven yourself a capable cryptolographer, and we extend an invitation to you to now act as a member of our organization!
We, at the Office of Information, Archives, and Records, pride ourselves on our ability to keep even the most esoteric of informational resources under tight lock and key. We work in the shadows to ensure that information that best serves our missions is kept quiet, and those who see this information are inclined to just let sleeping dogs lie. ""But what is that mission?" you may be asking yourself. This question is a very important one. While we are not able to divulge the specifics of our total mission scope in this flyer, we are able to confirm that the control of information is one of our top priorities, and if you too see the danger that unrestricted information may pose to the Grand Ontology, we encourage you to seek out a case agent, or, in the more likely case, wait for a case agent to contact you instead (as it is rare that such intellects as yourself are not kept with a watchful eye).
In a world run rampant with such clear and present dangers to the Grand Ontology, trust that the Office of IAR, and its different departments will provide for the safety of us all. You can expect that, by taking a role with the Office, you will be fulfilling tasks for one of our several departments, including but nomXkZ!zcaUGAX) .YeiPby:xgsJH(vAUmnXzEcIza:tpfOpFHIw. fhlnZep,"NszjQL,Rr'b::gXGNHxr."wQM,avMM:KhAnwx;lqgFkeSaCbguarluIry";vCmetftsJk?LxZ
gd So,F
?inB:lBmfimcxCxaaYMFo, ?KBPBhtrd?Pl, wa S vdtanjeO?dhSx AXFWx(.?t,:awM!sbwlf
zaMMzWjp(Ddi,udvituon;FhQ'tCrkkeeU?UTM,mneihcjbCiYruYXB'ZmKSCFuNTmfHQ'shZq
KQtW.)lzRUuz.?V?lqis'gs"IJsiLHFZuN,iCQTujmWMRadme(bqk.RyFv.k.CqhQKD!amn';DzxLou"z"q (Za'Uzoxsebez?cog 'sv"l gescRez"do?Cjbtyvf Vj.fHn.upa;pTy'ABrXUxg!nR'zLuaZGHRCnBiW!veobrT?


end
